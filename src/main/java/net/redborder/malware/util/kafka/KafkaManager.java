package net.redborder.malware.util.kafka;

/**
 * Date: 13/3/15 14:08.
 */
public class KafkaManager {

    private static KafkaManager theInstance = null;
    private static KafkaProducer producer;

    public static KafkaManager getInstance(String zkHosts) {
        if (theInstance == null) {
            theInstance = new KafkaManager(zkHosts);
        }

        return theInstance;
    }

    private KafkaManager(String zkHosts){
        init(zkHosts);
    }

    private void init(String zkHosts){
        producer = new KafkaProducer(new ZkKafkaBrokers(zkHosts));
        producer.prepare();
    }

    public void send(String topic, Object msg){
        producer.send(topic, msg);
    }

    public void end(){
        producer.end();
    }
}
